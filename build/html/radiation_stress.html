
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Calculation of radiation stresses &#8212; FUNWAVE Documentation</title>
    <link rel="stylesheet" href="_static/lglb-sphinx-doc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Post Processing" href="post.html" />
    <link rel="prev" title="Hot Start" href="hotstart.html" /> 
  </head><body>
<div class="header">
 <p class="logo"><a href="https://fengyanshi.github.io/build/html/index.html">
  <img class="logo" src="_static/../../../images/Funwave.svg" alt="Logo"/>
 </a></p>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="post.html" title="Post Processing"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="hotstart.html" title="Hot Start"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">FUNWAVE Documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="definition.html" ><strong>DEFINITIONS OF PARAMETERS</strong></a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="central_para.html" accesskey="U">Parameters for Central Module</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="basics.html"><strong>BASICS</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="flowchart.html"><strong>ARCHITECTURE</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="setup.html"><strong>MODEL DOWNLOAD AND SETUP</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html"><strong>Video Tutorials</strong></a></li>
<li class="toctree-l1 current"><a class="reference internal" href="definition.html"><strong>DEFINITIONS OF PARAMETERS</strong></a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="definition.html#input-txt">INPUT.TXT</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="definition.html#definitions">Definitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="definition.html#simulation-checklist">Simulation Checklist</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="coupling_nesting.html"><strong>NESTING AND COUPLING</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html"><strong>EXAMPLES</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="gallery.html"><strong>GALLERY</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="news.html"><strong>FUNWAVE-TVD WORKSHOP</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html"><strong>BIBLIOGRAPHY</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html"><strong>AUTHORS</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="addition.html"><strong>ADDITIONAL INFORMATION</strong></a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="calculation-of-radiation-stresses">
<span id="section-radiation"></span><h1>Calculation of radiation stresses<a class="headerlink" href="#calculation-of-radiation-stresses" title="Permalink to this headline">¶</a></h1>
<p><strong>Momentum Balance at the wave-averaged scale</strong></p>
<p>The <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>-direction momentum balances can be examined using the concept of radiation stresses introduced by Longuet-Higgins and Stewart (1964). The major terms in the momentum balances can be presented by the wave-averaged, depth-integrated shallow water equations for time-steady flow,</p>
<div class="math notranslate nohighlight" id="equation-radiation-stress-0">
<span class="eqno">(118)<a class="headerlink" href="#equation-radiation-stress-0" title="Permalink to this equation">¶</a></span>\[\frac{\partial \bar{P}\bar{P}/H}{\partial x} + \frac{\partial \bar{P}\bar{Q}/H}{\partial y}+ gH\frac{\partial \bar{\eta}}{\partial x}+ \frac{\partial S_{xx}}{\partial x} + \frac{\partial S_{xy}}{\partial y} + gH\frac{\partial \bar{\eta}}{\partial x} + \bar{\tau}_x+ R_x =0,\]</div>
<div class="math notranslate nohighlight" id="equation-radiation-stress-1">
<span class="eqno">(119)<a class="headerlink" href="#equation-radiation-stress-1" title="Permalink to this equation">¶</a></span>\[\frac{\partial \bar{Q}\bar{Q}/H}{\partial y} + \frac{\partial \bar{P}\bar{Q}/H}{\partial x}+ gH\frac{\partial \bar{\eta}}{\partial y}+ \frac{\partial S_{yy}}{\partial y} +  \frac{\partial S_{xy}}{\partial x} + gH\frac{\partial \bar{\eta}}{\partial y} + \bar{\tau}_y+ R_y =0,\]</div>
<p>where <span class="math notranslate nohighlight">\(\bar{()}\)</span> represents wave-averaging. <span class="math notranslate nohighlight">\(H = h + \bar{\eta}\)</span>, is the wave-averaged water depth with <span class="math notranslate nohighlight">\(h\)</span> and <span class="math notranslate nohighlight">\(\eta\)</span> representing the still water depth and surface elevation, respectively.  In the Cartesian coordinates (<span class="math notranslate nohighlight">\(x,y\)</span>), <span class="math notranslate nohighlight">\((\bar{P}, \bar{Q})\)</span> are wave-averaged volume fluxes in (<span class="math notranslate nohighlight">\(x,y\)</span>) directions. (<span class="math notranslate nohighlight">\(\bar{\tau}_x, \bar{\tau}_y)\)</span> represent the bottom friction. <span class="math notranslate nohighlight">\(g\)</span> is the gravitational acceleration constant.  The calculation of  radiation stresses <span class="math notranslate nohighlight">\(S_{xx} \)</span>, and <span class="math notranslate nohighlight">\(S_{xy}\)</span> is desribed below.
In the equations above, <span class="math notranslate nohighlight">\(R_x\)</span> and <span class="math notranslate nohighlight">\(R_y\)</span> are residual momentum terms in the momentum balances in <span class="math notranslate nohighlight">\(x-\)</span> and <span class="math notranslate nohighlight">\(y-\)</span> directions, respectively, including contributions from dispersive terms, diffusion terms, as well as numerical errors.</p>
<p><strong>Calculation of radiation stresses</strong></p>
<p>The radiation stresses can be expressed by</p>
<div class="math notranslate nohighlight" id="equation-radiation-stress-2">
<span class="eqno">(120)<a class="headerlink" href="#equation-radiation-stress-2" title="Permalink to this equation">¶</a></span>\[S_{xx} = \overline{\int_{-h}^\eta (u^2-w^2) dz } + \frac{1}{2} g \overline{\eta^2},\]</div>
<div class="math notranslate nohighlight" id="equation-radiation-stress-3">
<span class="eqno">(121)<a class="headerlink" href="#equation-radiation-stress-3" title="Permalink to this equation">¶</a></span>\[S_{yy} = \overline{\int_{-h}^\eta (v^2-w^2) dz } + \frac{1}{2} g \overline{\eta^2},\]</div>
<div class="math notranslate nohighlight" id="equation-radiation-stress-4">
<span class="eqno">(122)<a class="headerlink" href="#equation-radiation-stress-4" title="Permalink to this equation">¶</a></span>\[S_{xy} = \overline{\int_{-h}^\eta uv dz },\]</div>
<p>where <span class="math notranslate nohighlight">\((u,v,w)\)</span> represent velocity components in <span class="math notranslate nohighlight">\((x,y,z)\)</span> directions. The velocity components were estimated by modeled velocity field accurate up to <span class="math notranslate nohighlight">\(O(\mu^2)\)</span>.  To make it convenient to remove wave-averaged current velocity from the instantaneous velocity, we used the depth-averaged velocity <span class="math notranslate nohighlight">\(\tilde{\bf u} = \bf{u}_\alpha + {\bf \bar{u}}_2\)</span>, in which <span class="math notranslate nohighlight">\(\bf{u}_\alpha\)</span> denotes the velocity at a reference elevation and <span class="math notranslate nohighlight">\({\bf \bar{u}}_2\)</span> is the depth averaged <span class="math notranslate nohighlight">\(O(\mu^2)\)</span> contribution to the horizontal velocity field.
The vertical component <span class="math notranslate nohighlight">\(w\)</span> was estimated by <span class="math notranslate nohighlight">\(w(x,y,z,t) = - \mu^2 \nabla \cdot [(h+z) {\bf u}_{\alpha}]\)</span>. The depth-averaged vertical velocity <span class="math notranslate nohighlight">\(\tilde{w}\)</span> was roughly estimated as half of the vertical velocity at the surface, i.e., <span class="math notranslate nohighlight">\(\tilde{w} = w(x,y,\eta,t)/2\)</span>. The final expressions of radiation stresses are</p>
<div class="math notranslate nohighlight" id="equation-radiation-stress-5">
<span class="eqno">(123)<a class="headerlink" href="#equation-radiation-stress-5" title="Permalink to this equation">¶</a></span>\[S_{xx} = \overline{[(\tilde{u}-\tilde{u}_m)^2 - \tilde{w}^2] (h+\eta)} +\frac{1}{2} g \overline{\eta^2},\]</div>
<div class="math notranslate nohighlight" id="equation-radiation-stress-6">
<span class="eqno">(124)<a class="headerlink" href="#equation-radiation-stress-6" title="Permalink to this equation">¶</a></span>\[S_{yy} = \overline{[(\tilde{v}-\tilde{v}_m)^2 - \tilde{w}^2] (h+\eta)} +\frac{1}{2} g \overline{\eta^2},\]</div>
<div class="math notranslate nohighlight" id="equation-radiation-stress-7">
<span class="eqno">(125)<a class="headerlink" href="#equation-radiation-stress-7" title="Permalink to this equation">¶</a></span>\[S_{xy} = \overline{(\tilde{u}-\tilde{u}_m)(\tilde{v}-\tilde{v}_m) (h+\eta)},\]</div>
<p>where (<span class="math notranslate nohighlight">\(\tilde{u}_m, \tilde{v}_m\)</span>) represent the wave-averaged, depth-averaged velocities in (<span class="math notranslate nohighlight">\(x,y\)</span>) directions. As mentioned above, the use of depth-averaged wave velocity is for the purpose of removing wave-averaged current velocity from the wave component. Therefore, the ordering of the terms in the radiation stresses above is not consistent with the derivation of the fully nonlinear Boussinesq model (Wei et al., 1995). Errors may exist in <span class="math notranslate nohighlight">\(O(\mu^4)\)</span> contributions.</p>
<p>Calculations of time averaged quantities (<span class="math notranslate nohighlight">\(\tilde{u}_m, \tilde{v}_m\)</span>),    <span class="math notranslate nohighlight">\((\bar{P}, \bar{Q})\)</span> and the radiation stresses, <span class="math notranslate nohighlight">\(S_{xx}\)</span>, <span class="math notranslate nohighlight">\(S_{xy}\)</span>, <span class="math notranslate nohighlight">\(S_{yy}\)</span>, are integrated in specified time segments, such as 20 wave periods. In the calculations of the instantaneous wave velocity, such as <span class="math notranslate nohighlight">\(\tilde{u} - \tilde{u}_m\)</span>, the averaged value <span class="math notranslate nohighlight">\(\tilde{u}_m\)</span> is from the averaging in the last time segment.</p>
<p><strong>Output of radiation stress and other momentum balance terms</strong></p>
<p>To make outputs of radiation stress and other momentum balance terms, set</p>
<p><code class="code docutils literal notranslate"><span class="pre">Radiation</span> <span class="pre">=</span> <span class="pre">T</span></code></p>
<p><code class="code docutils literal notranslate"><span class="pre">T_INTV_mean</span> <span class="pre">=</span> <span class="pre">200.0</span></code></p>
<p>(average every 200 s)</p>
<p><code class="code docutils literal notranslate"><span class="pre">STEADY_TIME=1000.0</span></code></p>
<p>(make averaging after 1000 s)</p>
<p>List of terms (left column:file names with &lt; &gt; for file numbers, right column: terms):</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">DxSxx_&lt;</span> <span class="pre">&gt;</span></code> :   <span class="math notranslate nohighlight">\(\frac{\partial S_{xx}}{\partial x}\)</span></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">DySxy_&lt;</span> <span class="pre">&gt;</span></code> :   <span class="math notranslate nohighlight">\(\frac{\partial S_{xy}}{\partial y}\)</span></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">DxSxy_&lt;</span> <span class="pre">&gt;</span></code> :   <span class="math notranslate nohighlight">\(\frac{\partial S_{xy}}{\partial x}\)</span></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">DySyy_&lt;</span> <span class="pre">&gt;</span></code> :   <span class="math notranslate nohighlight">\(\frac{\partial S_{yy}}{\partial y}\)</span></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">DxUUH_&lt;</span> <span class="pre">&gt;</span></code> :   <span class="math notranslate nohighlight">\(\frac{\partial \bar{P}\bar{P}/H}{\partial x}\)</span></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">DyUVH_&lt;</span> <span class="pre">&gt;</span></code> :   <span class="math notranslate nohighlight">\(\frac{\partial \bar{P}\bar{Q}/H}{\partial y}\)</span></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">DxUVH_&lt;</span> <span class="pre">&gt;</span></code> :   <span class="math notranslate nohighlight">\(\frac{\partial \bar{P}\bar{Q}/H}{\partial x}\)</span></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">DyVVH_&lt;</span> <span class="pre">&gt;</span></code> :   <span class="math notranslate nohighlight">\(\frac{\partial \bar{Q}\bar{Q}/H}{\partial y}\)</span></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">PgrdX_&lt;</span> <span class="pre">&gt;</span></code> :   <span class="math notranslate nohighlight">\(gH\frac{\partial \bar{\eta}}{\partial x}\)</span></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">PgrdY_&lt;</span> <span class="pre">&gt;</span></code> :   <span class="math notranslate nohighlight">\(gH\frac{\partial \bar{\eta}}{\partial y}\)</span></p></li>
</ul>
<p><strong>Example</strong></p>
<p>An example of the momentum balance calculation can be found in <code class="code docutils literal notranslate"><span class="pre">/simple_cases/short_crest_radiation/</span></code> or Zhang et al. (2022).</p>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="post.html" title="Post Processing"
             >next</a> |</li>
        <li class="right" >
          <a href="hotstart.html" title="Hot Start"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">FUNWAVE Documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="definition.html" ><strong>DEFINITIONS OF PARAMETERS</strong></a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="central_para.html" >Parameters for Central Module</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, Fengyan Shi.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.1.2.
    </div>
  </body>
</html>