IG wave generation with 2nd-order correction
################################################

The wavemaker can take into account bound IG waves based on the weakly-nonlinear second-order finite-depth wave theory of Hasselmann (1962). A time series of wave surface elevation (:math:`\eta`) can be described by the linear superposition of free wave components, as in 

.. math:: \eta = \sum_{i=1}^N a_i \cos(2 \pi f_i t + \phi_i), 

where :math:`f_i` is the frequency and :math:`\phi_i` is the phase of :math:`i^{th}` wave component.  :math:`N` is the total number of free wave components. 
The sub-harmonic component (:math:`\eta_{ij}`) generated by two free waves :math:`i` and :math:`j`, is given by

.. math:: \eta_{ij} = D_{ij} a_i a_j \cos(f_{ij} t + \phi_{ij}),

where :math:`f_{ij} = f_j - f_i` and :math:`\phi_{ij}= \phi_j - \phi_i` (note :math:`f_j > f_i`), which represent the frequency and the phase of the sub-harmonic component, respectively.  :math:`D_{ij}` is the interaction coefficient given by 

.. math:: D_{ij} = -\frac{gk_i k_j}{2 \omega_i \omega_j} + \frac{\omega^2_i - \omega_i \omega_j + \omega^2_j}{2g} - C \frac{g(\omega_i - \omega_j)}{\omega_i \omega_j [gk_{ij}\tanh(k_{ij}h) - (\omega_i - \omega_j)^2]}, 

where :math:`\omega = 2 \pi f` is the radial frequency, and :math:`k_{ij} = k_i - k_j` is the wave number of the sub-harmonic component. :math:`C` is a coefficient given by

.. math:: C = (\omega_i - \omega_j) \left( \frac{\omega_i^2 \omega_j^2}{g^2} + k_i k_j \right) - \frac{1}{2} \left (\frac{\omega_i k_j^2}{\cosh^2(k_j h)} - \frac{\omega_j k_i^2}{\cosh^2(k_i h)} \right). 

The total surface elevation including the sub-harmonics can be described by

.. math:: \eta = \sum_{i=1}^n a_i \cos(2 \pi f_i t + \phi_i) + \sum_{i=n_1}^{n_2-2} \sum_{i+1}^{n_2} D_{ij} a_i a_j \cos(2 \pi f_{ij} + \phi_{ij}), 

where :math:`(n_1, n_2)` represent the range of free wave components for the sub-harmonic generation. In Li et al. (2020), for example, the range was selected from :math:`f(n_1)=0.5 f_p` to :math:`f(n_2)=1.5 f_p`, where :math:`f_p` was the spectral peak frequency. The range seclected in Malej (2021) is from :math:`f(n_1)=0.7 f_p` to :math:`f(n_2)=1.3 f_p`, smaller than Li et al. (2020). 


